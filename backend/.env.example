# Core
ENVIRONMENT=production
DATABASE_URL=postgresql+psycopg2://user:password@host:5432/eventsec
JWT_SECRET=change-me
SECRET_KEY=change-me
DETECTION_QUEUE_MODE=memory

# Optional secrets via files
SECRET_KEY_FILE=
AGENT_ENROLLMENT_KEY=change-me
AGENT_ENROLLMENT_KEY_FILE=

# OpenSearch
OPENSEARCH_URL=http://localhost:9200
OPENSEARCH_VERIFY_CERTS=true
OPENSEARCH_CA_FILE=
OPENSEARCH_CLIENT_CERTFILE=
OPENSEARCH_CLIENT_KEYFILE=
OPENSEARCH_MAX_RETRIES=3
OPENSEARCH_RETRY_BACKOFF_SECONDS=0.5

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8000
SERVER_HTTPS_ENABLED=false
SERVER_SSL_CERTFILE=
SERVER_SSL_KEYFILE=
SERVER_SSL_CA_FILE=
SERVER_SSL_CLIENT_CERT_REQUIRED=false

# CORS/Cookies/UI
CORS_ORIGINS=http://localhost:5173
CORS_ALLOW_ORIGIN_REGEX=
COOKIE_NAME=access_token
COOKIE_SAMESITE=lax
COOKIE_SECURE=
COOKIE_DOMAIN=
COOKIE_PATH=/
COOKIE_MAX_AGE_SECONDS=3600
UI_BASE_URL=http://localhost:5173

# Migrations
RUN_MIGRATIONS=true

# Notifications
MANAGER_EMAILS=
LEVEL1_DL=
LEVEL2_DL=
NOTIFICATION_DEDUP_MINUTES=2

# Network ingest
NETWORK_INGEST_MAX_EVENTS=1000
NETWORK_INGEST_MAX_BYTES=5000000

# Password Guard
PASSWORD_GUARD_RATE_LIMIT_PER_MINUTE=60

# Incidents
INCIDENT_AUTO_CREATE_ENABLED=true
INCIDENT_AUTO_CREATE_MIN_SEVERITY=high

# Feature flags
VULN_INTEL_ENABLED=true
FEATURE_INTEL_ENABLED=false
FEATURE_OT_ENABLED=false
FEATURE_EMAIL_ACTIONS_ENABLED=false
THREATMAP_FALLBACK_COORDS=false

# Vulnerability intel
VULN_INTEL_WORKER_ROLE=api
NVD_API_KEY=
NVD_BASE_URL=https://services.nvd.nist.gov/rest/json/cves/2.0
NVD_CPE_BASE_URL=https://services.nvd.nist.gov/rest/json/cpes/2.0
OSV_BASE_URL=https://api.osv.dev/v1/query
OSV_BATCH_URL=https://api.osv.dev/v1/querybatch
EPSS_BASE_URL=https://api.first.org/data/v1/epss
VULN_INTEL_HTTP_TIMEOUT_SECONDS=15
VULN_INTEL_HTTP_RETRIES=3
VULN_INTEL_CACHE_TTL_HOURS=24
VULN_INTEL_NOTIFY_IMMEDIATE_MIN_RISK=CRITICAL
VULN_INTEL_NOTIFY_DIGEST_ENABLED=true
VULN_INTEL_NOTIFY_DIGEST_HOUR_LOCAL=9
VULN_INTEL_TIMEZONE=Europe/Madrid
VULN_INTEL_CREATE_ALERTS_FOR_CRITICAL=true

# DB readiness
DB_READY_WAIT_ATTEMPTS=30
DB_READY_WAIT_INTERVAL_SECONDS=2.0
