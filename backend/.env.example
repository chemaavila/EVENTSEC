# EventSec Backend settings (pydantic Settings)
# Copy to backend/.env for local runs (python -m app.server)

# Runtime environment
ENVIRONMENT=development

# Database
DATABASE_URL=postgresql+psycopg2://eventsec:eventsec@localhost:5432/eventsec

# JWT/crypto secrets
SECRET_KEY=eventsec-dev-secret
# SECRET_KEY_FILE=/path/to/secret_key.txt

# Agent enrollment
AGENT_ENROLLMENT_KEY=eventsec-enroll
# AGENT_ENROLLMENT_KEY_FILE=/path/to/agent_enrollment_key.txt

# Agent shared token (used for ingest endpoints)
EVENTSEC_AGENT_TOKEN=eventsec-dev-token

# OpenSearch
OPENSEARCH_URL=http://localhost:9200
OPENSEARCH_VERIFY_CERTS=true
# OPENSEARCH_CA_FILE=/path/to/ca.pem
# OPENSEARCH_CLIENT_CERTFILE=/path/to/client.crt
# OPENSEARCH_CLIENT_KEYFILE=/path/to/client.key
OPENSEARCH_MAX_RETRIES=3
OPENSEARCH_RETRY_BACKOFF_SECONDS=0.5

# API server
SERVER_HOST=127.0.0.1
SERVER_PORT=8000
SERVER_HTTPS_ENABLED=false
# SERVER_SSL_CERTFILE=/certs/server.crt
# SERVER_SSL_KEYFILE=/certs/server.key
# SERVER_SSL_CA_FILE=/certs/ca.pem
SERVER_SSL_CLIENT_CERT_REQUIRED=false

# Notifications / UI
MANAGER_EMAILS=
LEVEL1_DL=
LEVEL2_DL=
UI_BASE_URL=http://localhost:5173
NOTIFICATION_DEDUP_MINUTES=2

# Ingest tuning
NETWORK_INGEST_MAX_EVENTS=1000
NETWORK_INGEST_MAX_BYTES=5000000
EVENT_QUEUE_MAXSIZE=2000

# Incident auto-create
INCIDENT_AUTO_CREATE_ENABLED=true
INCIDENT_AUTO_CREATE_MIN_SEVERITY=high

# Threat map
THREATMAP_TELEMETRY_MODE=live
# MAXMIND_DB_PATH=/path/to/GeoIP.mmdb
THREATMAP_REPLAY_SECONDS=60
THREATMAP_TTL_MS=45000
THREATMAP_AGG_TICK_MS=1000
THREATMAP_HB_TICK_MS=2000

# Backend entrypoint (Docker)
MIGRATION_ATTEMPTS=10
EVENTSEC_DB_DEBUG=0
SEED_SKIP_ON_ERROR=0
DB_READY_WAIT_ATTEMPTS=30
DB_READY_WAIT_INTERVAL_SECONDS=2
